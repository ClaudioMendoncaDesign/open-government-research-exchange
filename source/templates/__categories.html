{% extends '_base.html' %}

{% import '_macros.html' as $macros %}

{% block main %}
<div class="b-categories-page">
  <div class="b-filter-ui js-and">
    <div class="b-top-section m-{{title | slug}}">
      <div class="row">
        <div class="large-12 column">
          <h1>{{ title }}</h1>
          <h3 class="e-tagline">{{description}}</h3>
        </div>
        <span class="b-filter-ui-container js-multi">
          <div class="switch">
            <label>
              All Articles
              <input type="checkbox" class="b-filter" data-filter="f-open">
              <span class="lever"></span>
              Free Articles Only
            </label>
          </div>
        </span>
      </div>
    </div>
    <div class="b-divider b-filter-panel m-black">
      <h2>Filters</h2>

      <div class="row">
        <form action="#" class="b-form">

          {{ $macros.getFilterOptions("Organization", custom_filter, false, 1) }}
          {{ $macros.getFilterOptions("Objective", custom_filter, true, 2, "taxonomy") }}
          {{ $macros.getFilterOptions("Methodology", custom_filter, true, 3, "taxonomy") }}
          {{ $macros.getFilterOptions("Sector", custom_filter, false, 4) }}
          {{ $macros.getFilterOptions("Region", custom_filter, false, 5) }}
          {{ $macros.getFilterOptions("Type", custom_filter, false, 6) }}

{#           <div class="b-filter-ui-container">
            <div class="large-2 columns">
              <div class="e-select">
                <select name="" id="" class="b-filter js-change">
                  <option data-filter="*">Organization</option>
                  <option data-filter="f-mysociety">mySociety</option>
                  <option data-filter="f-the-govlab">GovLab</option>
                  <option data-filter="f-digital-engagement">Digital Engagement</option>
                </select>
              </div>
            </div>
          </div>

          <div class="b-filter-ui-container">
            <div class="large-2 columns">
              <div class="e-select">
                <select name="" id="" class="b-filter js-change">
                  <option data-filter="**">Objective</option>
                  <option data-filter="f-access">Access</option>
                  <option data-filter="f-effectiveness">Effectiveness</option>
                  <option data-filter="f-legitimacy">Legitimacy</option>
                  <option data-filter="f-participation">Participation</option>
                </select>
              </div>
            </div>
          </div>

          <div class="b-filter-ui-container">
            <div class="large-2 columns">
              <div class="e-select">
                <select name="" id="" class="b-filter js-change">
                  <option data-filter="***">Methodology</option>
                  <option data-filter="f-case-analysis">Case Analysis</option>
                  <option data-filter="f-quantitative-analysis">Quantitative Analysis</option>
                  <option data-filter="f-survey">Survey</option>
                </select>
              </div>
            </div>
          </div>

          <div class="b-filter-ui-container">
            <div class="large-2 columns">
              <div class="e-select">
                <select name="" id="" class="b-filter js-change">
                  <option data-filter="****">Sector</option>
                  <option data-filter="f-sector-1">Sector 1</option>
                  <option data-filter="f-sector-2">Sector 2</option>
                </select>
              </div>
            </div>
          </div>

          <div class="b-filter-ui-container">
            <div class="large-2 columns">
              <div class="e-select">
                <select name="" id="" class="b-filter js-change">
                  <option data-filter="*****">Region</option>
                  <option data-filter="f-region-1">Region 1</option>
                  <option data-filter="f-region-2">Region 2</option>
                </select>
              </div>
            </div>
          </div>

          <div class="b-filter-ui-container">
            <div class="large-2 columns">
              <div class="e-select">
                <select name="" id="" class="b-filter js-change js-clear">
                  <option data-filter="******">Type</option>
                  <option data-filter="f-type-1">Type 1</option>
                  <option data-filter="f-type-2">Type 2</option>
                </select>
              </div>
            </div>
          </div> #}

        </form>
      </div>
    </div>
  </div>

  <div class="b-page-section b-results-section b-isotope">
    {% for d in $global.papers %}

    {% set _match = false %}

    {% for i in d.taxonomy.category %}

    {% if i == custom_filter %}
    {% set _match = true %}
    {% endif %}

    {% endfor %}

    {% if _match %}
    <div class="b-result-item f-{{d.access | slug}} f-{{d.organization | slug}} {% for x in d.taxonomy.objective %}f-{{x | slug}}{% endfor %} {% for y in d.taxonomy.methodology %}f-{{y | slug}}{% endfor %} f-{{d.sector | slug}} f-{{d.sector | slug}} f-{{d.type | slug}}">
      <a href="{{d.url}}" title="{{d.title}}">
        {# {% if d.cover_image %}
        <div class="e-result-image" style="background-image: url('{{d.cover_image}}')"></div>
        {% endif %} #}

        <h3 class="e-result-name">{{d.title}}</h3>

        {% if d.authors %}
        <p class="e-result-authors">{% for a in d.authors %} {{a}}, {% endfor %}</p>
        {% endif %}

        {% if d.taxonomy.methodology %}
        <div class="e-result-taxonomy m-methodology">
          <p>Methodology</p>
          {% for met in d.taxonomy.methodology %} <span>{{met}}</span> {% endfor %}
        </div>
        {% endif %}

        {% if d.taxonomy.objective %}
        <div class="e-result-taxonomy m-objective">
          <p>Objective</p>
          {% for obj in d.taxonomy.objective %} <span>{{obj}}</span> {% endfor %}</div>
          {% endif %}

          <div class="e-result-extras">
            {% if d.github %} <img src="img/github-logo.svg" alt=""> {% endif %}
            {% if d.datasets %} <i class="material-icons" title="Datasets">file_download</i>{% endif %}
          </div>
        </a>
      </div>
      {% endif %}
      {% endfor %}
    </div>
  </div>
  {% endblock %}